<!DOCTYPE html>
<html>

<head>
    <title> BASE FILE DO NOT TOUCH - CSV File to HTML Table Using AJAX jQuery</title>
    <!-- All local includes -->
    <script src="./scripts/jquery.min.js"></script>
    <link rel="stylesheet" href="./styles/bootstrap.css" />
    <script src="./scripts/bootstrap.min.js"></script>

</head>

<body>
    <div class="container">
        <div class="table-responsive">
            <h1 align="center">Outlet Name Goes Here</h1>
            <br />
            <div align="center">
                <button type="button" name="load_data" id="load_data" class="btn btn-info">Load Data</button>
            </div>
            <br />
            <div id="menu_table">
            </div>
        </div>
    </div>

    <includes>

    </includes>


</body>

</html>

<script>




    $(document).ready(function () {
        $('#load_data').click(function () {
            $.ajax({

                //This is a SEMICOLON DELIMITED CSV file in the ROOT FOLDER. TODO: Consider nesting this to prevent shallow visibility.
                url: "supplier_markers.csv",

                //type of data to expect
                dataType: "text",

                //success will run a function when the pairs above resolve successfully
                success: function (data) {

                    // split file into entries by linebreak
                    var supplier_list = data.split(/\r?\n|\r/);

                    console.log('Supplier list retrieved: ' + supplier_list + '\n\r Which is object type: ' + typeof (supplier_list));

                    //Keep track of the # of  markers. This will be used to match legend tags with map marker numbers. Skip the first (these are table headers). 
                    var markerTracker = 0;

                    //Process the supplier_list array into a unique "supplier" string each time we iterate. This is the index counter.
                    for (var counter = 0; counter < supplier_list.length; counter++) {


                        // Split the supplier_list into entries. This is another Array containinf the information for one supplier.
                        var supplier = supplier_list[counter].split(";");


                        //If this is the first iteration, increment the counter and skip the supplier headers.
                        if (counter === 0 || supplier[0] === "") {
                            markerTracker++;
                            //TODO: WE will create an array containing all headers - this will be our temp variable names!!
                            //Or will we??..

                            //Stop this iteration and do not read information from this data field.
                            continue;


                        } else {

                            // Code that will run on the rest of the iterations that pass the conditions.

                            //split the current index into the separated values for this entry
                            // *****UNCOMMENT FOR DEBUG*****
                            console.log(markerTracker);
                            console.log('Supplier currently indexed: ' + supplier + '\n Which is data type: ' + typeof (supplier));


                            //This is the loop that will iterate through the data fields of each supplier. Here we will work on the data.
                            for (var cell_counter = 0; cell_counter < supplier.length; cell_counter++) {


                                var currName = supplier[0];//first element is name. we will trim it and create the ID.
                                //TODO: We can technically add 0-6 right now. But how will we handle empty cells? with NA?(smart to include blank)

                                var currDataID = currName.replace(/[^a-zA-Z0-9]/g, ''); //Strip name of all spaces and characters
                                currDataID = currDataID.charAt(0) + currDataID.substring(1).toLowerCase();




                                console.log(supplier[cell_counter]);
                                console.log(currDataID);
                                //eval();//we will use eval to create the dynamic variables for each iteration.





                            }
                            //After Creating this marker, increment the counter for the next one.
                            markerTracker++;
                            console.log(markerTracker);
                        }

                    }
                }
            });
        });

    });





</script>